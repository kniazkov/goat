var dll = dlopen("../goat-web/goat-web.dll");
var createServer = dll.find("create_server");
var tick = dll.find("tick");

var counter = 0;

var cb = $(request)
{
    counter++;
    //println("An event handled: " + request);
    var response = 
        "Counter value: " + counter;
    return {
        content: response.encode("utf8"),
        type: "text/html"
    };
};

var server = createServer(8001, cb);
println(server);
while(true)
{
    tick(server);
}
